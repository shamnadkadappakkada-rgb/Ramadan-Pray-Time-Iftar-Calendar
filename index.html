<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Worldwide Ramadan Calendar with Prayer Times</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Poppins:wght@300;400;600;700&display=swap');

body{
margin:0;
font-family:'Poppins',sans-serif;
background:#05070d;
color:white;
overflow-x:hidden;
}

/* Background */
.overlay{
position:fixed;
width:100%;
height:100%;
background:radial-gradient(circle at center,#0b0f1c,#000);
z-index:-3;
}

/* Stars */
.stars{
position:fixed;
width:100%;
height:100%;
z-index:-2;
}
.star{
position:absolute;
width:2px;
height:2px;
background:white;
border-radius:50%;
animation: twinkle 4s infinite alternate;
}
@keyframes twinkle{from{opacity:0.2;}to{opacity:1;}}

/* Ultra Moon */
.moon-container{
position:absolute;
top:30px;
left:50%;
transform:translateX(-50%);
width:170px;
height:170px;
}

.moon{
position:relative;
width:170px;
height:170px;
border-radius:50%;
background:radial-gradient(circle at 30% 30%, #ffffff 5%, #f5deb3 40%, #d4af37 100%);
box-shadow:0 0 100px rgba(255,215,0,0.6);
overflow:hidden;
animation: floatMoon 8s ease-in-out infinite;
}
.moon-shadow{
position:absolute;
top:0;
left:0;
width:170px;
height:170px;
border-radius:50%;
background:#05070d;
transition:1s;
}
@keyframes floatMoon{
0%{transform:translateY(0);}
50%{transform:translateY(12px);}
100%{transform:translateY(0);}
}

/* Header */
.top-banner{
position:relative;
text-align:center;
padding-top:240px;
}
.top-banner h1{
font-family:'Amiri', serif;
font-size:40px;
background:linear-gradient(45deg,#FFD700,#FFA500);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
}
.dev{font-size:14px;opacity:0.8;}

.container{
max-width:1000px;
margin:30px auto;
padding:25px;
background:rgba(255,255,255,0.05);
border-radius:20px;
}

.controls{text-align:center;margin-bottom:15px;}
button,input,select{
padding:8px 12px;
margin:5px;
border-radius:25px;
border:none;
}
button{background:linear-gradient(45deg,#FFD700,#FFA500);cursor:pointer;}

.highlight{
background:#FFD700;
color:black;
padding:5px 10px;
border-radius:6px;
font-weight:bold;
}

table{
width:100%;
margin-top:20px;
border-collapse:collapse;
background:rgba(0,0,0,0.8);
}
th,td{
padding:8px;
border-bottom:1px solid rgba(255,255,255,0.2);
text-align:center;
}
th{background:#1f2833;}
.current-day{
background:#FFA500 !important;
color:black;
font-weight:bold;
}
</style>
</head>

<body>

<div class="overlay"></div>
<div class="stars"></div>

<div class="moon-container">
<div class="moon">
<div class="moon-shadow" id="moonShadow"></div>
</div>
</div>

<div class="top-banner">
<h1>üåô Ramadan Mubarak | ÿ±ŸÖÿ∂ÿßŸÜ ŸÖÿ®ÿßÿ±ŸÉ</h1>
<p><strong>Worldwide Ramadan Calendar 2026</strong></p>
<p class="dev">Developed by: Shamnad Sharafudeen (D-Bross)</p>
</div>

<div class="container" id="content">

<div class="controls">
<button onclick="getLocation()">üìç Auto Detect</button>
<input type="text" id="city" placeholder="Enter City">
<button onclick="manualSearch()">Search</button>
<button onclick="downloadPDF()">üìÑ PDF</button>
<button onclick="toggleAdhaan()" id="adhaanBtn">üîä Adhaan ON</button>
</div>

<div id="result"></div>
<div id="calendar"></div>

</div>

<audio id="adhaanAudio" preload="auto">
<source src="https://cdn.islamic.network/audio/adhan/adhan.mp3">
</audio>

<script>
/* Stars */
const starsContainer=document.querySelector('.stars');
for(let i=0;i<180;i++){
const star=document.createElement('div');
star.classList.add('star');
star.style.top=Math.random()*100+'%';
star.style.left=Math.random()*100+'%';
starsContainer.appendChild(star);
}

/* Real Moon Phase */
function calculateMoonPhase(){
const knownNewMoon=new Date("2024-01-11T00:00:00");
const today=new Date();
const lunarCycle=29.53058867;
const diff=(today-knownNewMoon)/(1000*60*60*24);
return diff%lunarCycle;
}
function renderMoon(){
const phase=calculateMoonPhase()/29.53058867;
const shadow=document.getElementById("moonShadow");
let offset;
if(phase<=0.5){offset=-170+(phase*340);}
else{offset=(phase-0.5)*340;}
shadow.style.left=offset+"px";
}
renderMoon();

/* Adhaan */
let adhaanEnabled=true;
function toggleAdhaan(){
adhaanEnabled=!adhaanEnabled;
document.getElementById("adhaanBtn").innerHTML=adhaanEnabled?"üîä Adhaan ON":"üîá Adhaan OFF";
}

/* Countdown */
function startCountdown(time,id){
function update(){
let now=new Date();
let target=new Date();
let [h,m]=time.split(":");
target.setHours(h,m,0);
if(target<now) target.setDate(target.getDate()+1);
let diff=target-now;
let hrs=Math.floor(diff/(1000*60*60));
let mins=Math.floor((diff%(1000*60*60))/(1000*60));
let secs=Math.floor((diff%(1000*60))/1000);
document.getElementById(id).innerHTML=`${hrs}h ${mins}m ${secs}s`;
}
update();
setInterval(update,1000);
}

/* Location & API */
function getLocation(){
navigator.geolocation.getCurrentPosition(pos=>{
fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${pos.coords.latitude}&lon=${pos.coords.longitude}`)
.then(res=>res.json())
.then(data=>{
let city=data.address.city||data.address.town||data.address.village;
let country=data.address.country;
loadRamadan(city,country);
});
});
}

function manualSearch(){
loadRamadan(document.getElementById("city").value,"");
}

async function loadRamadan(city,country){
let hijriYear=new Date().getFullYear()-579;
const response=await fetch(`https://api.aladhan.com/v1/hijriCalendarByCity/${hijriYear}/9?city=${city}&country=${country}&method=4`);
const data=await response.json();

let todayDate=new Date();
let currentDay=todayDate.getDate();
let today=data.data.find(d=>parseInt(d.date.gregorian.day)===currentDay);
if(!today) today=data.data[0];

document.getElementById("result").innerHTML=`
<h3>${city}</h3>
<p><strong>${today.date.gregorian.weekday.en}</strong>, ${today.date.gregorian.date} (${today.date.hijri.date})</p>
<p class="highlight">üåÖ Fajr: ${today.timings.Fajr} | ‚è≥ <span id="fajrCount"></span></p>
<p>Dhuhr: ${today.timings.Dhuhr}</p>
<p>Asr: ${today.timings.Asr}</p>
<p class="highlight">üåô Maghrib: ${today.timings.Maghrib} | ‚è≥ <span id="maghribCount"></span></p>
<p>Isha: ${today.timings.Isha}</p>
`;

startCountdown(today.timings.Fajr.split(" ")[0],"fajrCount");
startCountdown(today.timings.Maghrib.split(" ")[0],"maghribCount");

/* 30 Days Full Table */
let table=`<h3>Complete Ramadan Day List</h3>
<table>
<tr>
<th>Day</th>
<th>Date</th>
<th>Fajr</th>
<th>Dhuhr</th>
<th>Asr</th>
<th>Maghrib</th>
<th>Isha</th>
</tr>`;

data.data.forEach((day,index)=>{
let isToday=parseInt(day.date.gregorian.day)===currentDay;
table+=`<tr class="${isToday?'current-day':''}">
<td>${index+1}</td>
<td>${day.date.gregorian.weekday.en}<br>${day.date.gregorian.date}<br><small>${day.date.hijri.date}</small></td>
<td>${day.timings.Fajr}</td>
<td>${day.timings.Dhuhr}</td>
<td>${day.timings.Asr}</td>
<td>${day.timings.Maghrib}</td>
<td>${day.timings.Isha}</td>
</tr>`;
});
table+="</table>";
document.getElementById("calendar").innerHTML=table;
}

function downloadPDF(){
html2pdf().from(document.getElementById("content"))
.set({jsPDF:{format:'a4',orientation:'portrait'}})
.save("Ramadan-Prayer-Times.pdf");
}
</script>

</body>
</html>
