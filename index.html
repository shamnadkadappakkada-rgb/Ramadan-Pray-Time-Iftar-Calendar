<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Worldwide Ramadan Calendar</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Poppins:wght@300;400;600;700&display=swap');

/* üåå Night Sky */
body{
margin:0;
font-family:'Poppins',sans-serif;
background:radial-gradient(ellipse at bottom,#0d1b2a 0%,#000814 100%);
color:white;
overflow-x:hidden;
position:relative;
}

/* ‚ú® Animated Stars */
.stars{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
z-index:0;
overflow:hidden;
}

.star{
position:absolute;
width:2px;
height:2px;
background:white;
border-radius:50%;
animation:twinkle 3s infinite ease-in-out;
}

@keyframes twinkle{
0%,100%{opacity:0.2;}
50%{opacity:1;}
}

/* üåô Ultra Realistic Moon Right */
.moon-right{
position:fixed;
top:80px;
right:60px;
width:150px;
height:150px;
border-radius:50%;
background:radial-gradient(circle at 30% 30%, #fffef5 0%, #f8e8c8 35%, #d4af37 60%, #a67c00 100%);
box-shadow:
0 0 60px rgba(255,215,0,0.8),
0 0 120px rgba(255,215,0,0.4),
inset -25px -25px 40px rgba(0,0,0,0.45),
inset 15px 15px 25px rgba(255,255,255,0.25);
animation:floatMoonRight 6s ease-in-out infinite;
z-index:1;
}

/* üåô Half Moon Left */
.moon-left{
position:fixed;
top:100px;
left:60px;
width:120px;
height:120px;
border-radius:50%;
background:radial-gradient(circle at 40% 40%, #fffef5 0%, #e6c76b 60%, #a67c00 100%);
box-shadow:
0 0 40px rgba(255,215,0,0.7),
inset -20px -20px 35px rgba(0,0,0,0.55),
inset 10px 10px 20px rgba(255,255,255,0.2);
clip-path: inset(0 50% 0 0);
animation:floatMoonLeft 8s ease-in-out infinite;
z-index:1;
}

@keyframes floatMoonRight{
0%{transform:translateY(0);}
50%{transform:translateY(-25px);}
100%{transform:translateY(0);}
}

@keyframes floatMoonLeft{
0%{transform:translateY(0);}
50%{transform:translateY(-18px);}
100%{transform:translateY(0);}
}

/* Header */
.top-banner{
text-align:center;
padding:150px 10px 20px;
position:relative;
z-index:2;
}

.arabic-main{
font-family:'Amiri', serif;
font-size:42px;
color:#FFD700;
}

.english-main{
font-size:32px;
color:#FFD700;
margin-top:5px;
}

.developer-line{
margin-top:8px;
font-size:14px;
opacity:0.9;
}

#todayDateDisplay{
color:#FFD700;
font-weight:600;
margin-top:10px;
}

.container{
max-width:950px;
margin:30px auto;
padding:25px;
border-radius:20px;
background:rgba(255,255,255,0.05);
position:relative;
z-index:2;
}

.controls{text-align:center;margin-bottom:15px;}
button,input,select{padding:10px 14px;margin:6px;border-radius:30px;border:none;font-weight:600;}
button{background:linear-gradient(45deg,#FFD700,#FFA500);cursor:pointer;}
select{background:#FFD700;}
input{background:rgba(255,255,255,0.15);color:white;border:1px solid rgba(255,255,255,0.3);}

table{
width:100%;
margin-top:25px;
border-collapse:collapse;
background:rgba(0,0,0,0.85);
}
th,td{
padding:10px;
border-bottom:1px solid rgba(255,255,255,0.2);
text-align:center;
}
th{background:#1f2833;}
.highlight{
background:rgba(212,175,55,0.18);
border:1px solid rgba(212,175,55,0.5);
color:#FFD700;
font-weight:600;
border-radius:6px;
padding:6px;
}
.current-day{
background:rgba(212,175,55,0.25);
border-left:3px solid #FFD700;
}
.hijri-date{
font-size:13px;
opacity:0.8;
}
</style>
</head>

<body>

<div class="stars" id="stars"></div>
<div class="moon-right"></div>
<div class="moon-left"></div>

<div class="top-banner">
<div class="arabic-main">ÿ±ŸÖÿ∂ÿßŸÜ ŸÖÿ®ÿßÿ±ŸÉ</div>
<div class="english-main">Ramadan Mubarak</div>
<div class="developer-line">Developed by: Shamnad Sharafudeen (D-Bross)</div>
<p id="todayDateDisplay"></p>
<div id="todayPrayers"></div>
</div>

<div class="container" id="content">
<div class="controls">
<select onchange="changeLanguage(this.value)">
<option value="en">English</option>
<option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
<option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
<option value="ur">ÿßÿ±ÿØŸà</option>
</select>

<button onclick="getLocation()">üìç Auto Detect</button>
<input type="text" id="city" placeholder="Enter City">
<button onclick="manualSearch()">Search</button>
<button onclick="downloadPDF()">üìÑ PDF</button>
<button onclick="toggleAdhaan()" id="adhaanBtn">üîä Auto Adhaan ON</button>
</div>

<div id="calendar"></div>
</div>

<audio id="adhaanAudio" preload="auto">
<source src="https://cdn.islamic.network/audio/adhan/adhan.mp3" type="audio/mpeg">
</audio>

<script>
/* Generate Stars */
const starContainer=document.getElementById("stars");
for(let i=0;i<250;i++){
let star=document.createElement("div");
star.classList.add("star");
star.style.top=Math.random()*100+"%";
star.style.left=Math.random()*100+"%";
star.style.animationDuration=(2+Math.random()*4)+"s";
star.style.opacity=Math.random();
starContainer.appendChild(star);
}

/* ===== SEARCH & AUTO DETECT FIX ===== */
async function getLocation(){
if(!navigator.geolocation){ alert("Geolocation not supported"); return; }
navigator.geolocation.getCurrentPosition(async function(position){
try{
const lat = position.coords.latitude;
const lon = position.coords.longitude;
const response = await fetch(
`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`
);
const data = await response.json();
let city = data.address.city || data.address.town || data.address.village || data.address.state || data.address.county;
let country = data.address.country || "";
if(!city){ alert("City not detected. Please search manually."); return; }
loadRamadan(city, country);
}catch(e){console.error(e); alert("Location detection failed. Please try manual search.");}
}, function(){alert("Location permission denied.");});
}

function manualSearch(){
let city=document.getElementById("city").value.trim();
if(city===""){alert("Please enter city name."); return;}
loadRamadan(city,"");
}

/* Keep remaining script as-is (prayer system, renderCalendar, table, PDF) */
</script>

</body>
</html>
