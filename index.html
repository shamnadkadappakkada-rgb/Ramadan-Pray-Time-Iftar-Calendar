<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Worldwide Ramadan Calendar with Prayer Times</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Poppins:wght@300;400;600;700&display=swap');

body{
    margin:0;
    font-family:'Poppins',sans-serif;
    background:#0b0c10;
    color:white;
    overflow-x:hidden;
}

.overlay{
    position:fixed;
    width:100%;
    height:100%;
    background:linear-gradient(135deg,#000000,#000c25);
    z-index:-2;
}

.top-banner{
    text-align:center;
    padding:120px 10px 30px;
}

.top-banner h1{
    font-family:'Amiri', serif;
    font-size:42px;
    background:linear-gradient(45deg,#FFD700,#FFA500);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
}

.dev{font-size:14px;opacity:0.8;margin-bottom:10px;}

#todayDates{
    font-size:16px;
    margin-bottom:10px;
}

#topFajrMaghrib{
    margin-top:10px;
    font-size:18px;
    font-weight:bold;
    color:#00e5ff;
    text-shadow:0 0 10px #00e5ff;
}

#nextPrayerCountdown{
    margin-top:8px;
    font-size:16px;
    color:#00ffff;
}

.container{
    max-width:950px;
    margin:30px auto;
    padding:30px;
    border-radius:25px;
    background:rgba(255,255,255,0.05);
}

.controls{text-align:center;margin-bottom:15px;}

button,input,select{
    padding:10px 14px;
    margin:6px;
    border-radius:30px;
    border:none;
    font-weight:600;
}

button{
    background:linear-gradient(45deg,#FFD700,#FFA500);
    cursor:pointer;
}

input{
    background:rgba(255,255,255,0.15);
    color:white;
    border:1px solid rgba(255,255,255,0.3);
}

select{
    background:rgba(255,255,255,0.2);
    color:white;
}

table{
    width:100%;
    margin-top:25px;
    border-collapse:collapse;
    background:rgba(0,0,0,0.8);
}

th,td{
    padding:8px;
    border-bottom:1px solid rgba(255,255,255,0.2);
    text-align:center;
}

th{background:#1f2833;}

/* New Attractive Theme Highlight */
.highlight{
    background:#00e5ff;
    color:black;
    font-weight:bold;
}

/* Only Day Column Highlight */
.current-day{
    background:#00e5ff !important;
    color:black;
    font-weight:bold;
}
</style>
</head>

<body>

<div class="overlay"></div>

<div class="top-banner">
<h1>üåô Ramadan Mubarak | ÿ±ŸÖÿ∂ÿßŸÜ ŸÖÿ®ÿßÿ±ŸÉ</h1>
<p class="dev">Developed by: Shamnad Sharafudeen (D-Bross)</p>
<p id="todayDates"></p>

<div id="topFajrMaghrib"></div>
<div id="nextPrayerCountdown"></div>
</div>

<div class="container" id="content">

<div class="controls">
<button onclick="getLocation()">üìç Auto Detect</button>
<input type="text" id="city" placeholder="Enter City">
<button onclick="manualSearch()">Search</button>
<button onclick="downloadPDF()">üìÑ PDF</button>
</div>

<div id="calendar"></div>
</div>

<audio id="adhaanAudio" preload="auto">
<source src="https://cdn.islamic.network/audio/adhan/adhan.mp3" type="audio/mpeg">
</audio>

<script>

let lastData=null;

async function loadRamadan(city,country){
let hijriYear=new Date().getFullYear()-579;
const response=await fetch(`https://api.aladhan.com/v1/hijriCalendarByCity/${hijriYear}/9?city=${city}&country=${country}&method=4`);
const data=await response.json();
lastData=data;
renderCalendar(data);
}

function manualSearch(){
let city=document.getElementById("city").value;
loadRamadan(city,"");
}

function renderCalendar(data){

let todayDate=new Date();
let currentDay=todayDate.getDate();
let today=data.data.find(d=>parseInt(d.date.gregorian.day)===currentDay);
if(!today) today=data.data[0];

/* Today Date under Developed by */
document.getElementById("todayDates").innerHTML=
`Today: ${today.date.gregorian.date} (${today.date.gregorian.weekday.en})
<br>${today.date.hijri.date} Hijri`;

/* Fajr & Maghrib Top Only */
document.getElementById("topFajrMaghrib").innerHTML=
`üåÖ Fajr: ${today.timings.Fajr.split(" ")[0]} | üåô Maghrib: ${today.timings.Maghrib.split(" ")[0]}`;

/* Countdown */
startNextPrayerCountdown(today.timings);

/* Table */
let table=`<table>
<tr>
<th>Day</th>
<th>Date</th>
<th>Fajr</th>
<th>Dhuhr</th>
<th>Asr</th>
<th>Maghrib</th>
<th>Isha</th>
</tr>`;

data.data.forEach((day,index)=>{

let isToday=parseInt(day.date.gregorian.day)===currentDay;

table+=`<tr>
<td class="${isToday?'current-day':''}">${index+1}</td>
<td>
${day.date.gregorian.date}
<br>
${day.date.hijri.date}
</td>
<td class="highlight">${day.timings.Fajr.split(" ")[0]}</td>
<td>${day.timings.Dhuhr.split(" ")[0]}</td>
<td>${day.timings.Asr.split(" ")[0]}</td>
<td class="highlight">${day.timings.Maghrib.split(" ")[0]}</td>
<td>${day.timings.Isha.split(" ")[0]}</td>
</tr>`;
});

table+="</table>";
document.getElementById("calendar").innerHTML=table;
}

/* Countdown Function */
let countdownInterval=null;

function startNextPrayerCountdown(timings){

if(countdownInterval) clearInterval(countdownInterval);

countdownInterval=setInterval(()=>{

let now=new Date();
let prayersOrder=["Fajr","Dhuhr","Asr","Maghrib","Isha"];
let nextPrayer=null;

for(let p of prayersOrder){
let [h,m]=timings[p].split(" ")[0].split(":");
let prayerTime=new Date();
prayerTime.setHours(h,m,0);
if(prayerTime>now){nextPrayer=p;break;}
}

if(!nextPrayer) nextPrayer="Fajr";

let [h,m]=timings[nextPrayer].split(" ")[0].split(":");
let target=new Date();
target.setHours(h,m,0);
if(target<now) target.setDate(target.getDate()+1);

let diff=target-now;

let hrs=Math.floor(diff/(1000*60*60));
let mins=Math.floor((diff%(1000*60*60))/(1000*60));
let secs=Math.floor((diff%(1000*60))/1000);

document.getElementById("nextPrayerCountdown").innerHTML=
`Next ${nextPrayer} in ${hrs}h ${mins}m ${secs}s`;

},1000);
}

function downloadPDF(){
html2pdf().from(document.getElementById("content"))
.set({jsPDF:{format:'a4',orientation:'portrait'}})
.save("Ramadan-Pray-Time.pdf");
}

</script>
</body>
</html>
